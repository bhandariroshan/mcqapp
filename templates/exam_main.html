{% extends 'exam_base.html' %}
{% load staticfiles %} 
{% block timer %}
<div id="ioe_exam_starter" style="text-align:center;">
<input type="button" id="full_screen_button" value="Start Exam" onclick="show_fullscreen()">
</div>
<div id="ioe_exam_zoomer" style="text-align:right;">
<img src="/static/images/fullscreen.png" value="Start Exam" onclick="show_fullscreen()">
</div>
<div id="full_screen_content">
<div id="full_screen_inner_content">
    <h5 class="h-text-align " style="margin-top:0%;margin-left: 2%;margin-right: -2%;">
    <strong>Tribhuvan University</strong><br>
    <strong>Institute of Engineering </strong><br>
    <strong>Pulchowk, Lalitpur, Nepal</strong><br>
    <strong>{{exam_details.exam_name}}</strong>
    </h5>


    <div id="exam_login_container">
      <!-- <input type="text" id="input1" class="osk-trigger" placeholder="disable return" data-osk-options="disableReturn">< -->
      <!-- <input type="text" id="input2" class="osk-trigger" placeholder="disable symbols" data-osk-options="disableSymbols">  -->
      <label>Username</label><input type="text" id="exam_username" class="osk-trigger" placeholder="Username">
      <label>Password</label><input type="password" id="exam_password" class="osk-trigger" placeholder="Password">
      <!-- <textarea id="input4" class="osk-trigger" placeholder="enable everything"></textarea> -->
      
      <input type="button" value="Submit" onclick="start_ioe_exam()"> <input onclick="clear_login()" type="button" value="Cancel">

    </div>

  <script src="/static/js/jquery.onScreenKeyboard.js"></script>
    <script src="http://sindresorhus.com/screenfull.js/src/screenfull.js"></script>

<div id="exam_questions">
    <div class="twelve columns" style="margin-top:2%; margin-bottom:2%;">          
          <div class="six columns" id="startTimer">
                <!-- <h5 style="color:rgb(104, 16, 16);"><strong><i class="icon-clock"></i>Started {{exam_details.exam_time}}</strong></h5> -->
          </div>
          <div class="six columns">
                <div class="twelve columns">
                  <div class="seven columns">                  
                  </div>                
                  <div class="four columns" style="float: right;">
                    <img src="{{user.profile_image}}" style="height: 100px; "/>
                    <p style="font-weight: 400; font-size: 12px; margin-bottom: 0px;">{{user.name}}</p> 
                    <p  id="attempted" style="font-weight: 400; font-size: 12px;margin-bottom: 0px;">Attempted: 5 </p>
                    <p id="remaining" style="font-weight: 400; margin-bottom: 0px; font-size: 12px;">Remaining: 25</p>
                    <p id="remaining" style="font-weight: 400; margin-bottom: 0px; font-size: 12px;color:red;">Time Remained: </p>
                    <p  style="font-weight: 400; margin-bottom: 0px; font-size: 12px;">Total: 65</p>
                  </div>
                  <div class="one columns"></div>
                </div>
                <div class="twelve columns">
                  <div class="seven columns">                  
                  </div>                
                  <div class="four columns">
                    <h5 id="timeRemained" data-intro="determine the time left" data-position="bottom" style="float:right; color:rgb(104, 16, 16);"><strong></strong></h5>
                  </div>
                  <div class="one columns"></div>
                </div>
          </div><br/><br/>
    </div>
{% endblock %}
{% block exam_content %}
    
      <div class="twelve columns" id="showExam">      
        {% for each_question in questions %}       
        <div id="questionText_{{each_question.question_number}}" data-intro="Read the question carefully" data-position="top" class="div-margin twelve columns ui-widget-content ui-corner-all question-min-height" style="margin-left:-2%">
          <span  style="font-weight:bold;"><span style="color:blue;">{{each_question.question_number}}. </span> {{ each_question.question.text }} </span><br>
          {% if each_question.question.image != '' %}

          <img src="/static/images/{{exam_code}}/{{each_question.question.image}}" style=" height:140px" />
          {% endif %}

        <ul class="row" id="{{each_question.uid.id}}">
          <li class="field" style="min-height:30px;">
            <div class="clickDiv" id="div_{{each_question.question_number}}_OptionA" style="vertical-align:middle;"><span></span>            
                <a href="javascript:void(0)">
                <label class="radio" for="radio_{{each_question.question_number}}_A">
                  <input name="radio_{{each_question.question_number}}" id="radio_{{each_question.question_number}}_A" value="A" type="radio">
                  <span></span> 
                </label>
                
                {{ each_question.answer.a.text }}<br>
                {% if each_question.answer.a.image != '' %}
                  <img src="/static/images/{{exam_code}}/{{each_question.answer.a.image}}" style="height:140px;" />
                {% endif %}
                </a>
            </div>
          </li>

          <li class="field" style="min-height:30px;">
            <div class="clickDiv " id="div_{{each_question.question_number}}_OptionB" style="vertical-align:middle;"><span></span>
                <a href="javascript:void(0)">
                    <label class="radio" for="radio_{{each_question.question_number}}">
                        <input name="radio_{{each_question.question_number}}" id="radio_{{each_question.question_number}}_B" value="B" type="radio">
                        <span></span> 
                    </label>                  
                    {{ each_question.answer.b.text }}<br>
                    {% if each_question.answer.b.image != '' %}
                      <img src="/static/images/{{exam_code}}/{{each_question.answer.b.image}}" style="height:140px;" />
                    {% endif %}
                    </a>
            </div>
          </li>

          <li class="field" style="min-height:30px;">
            <div class="clickDiv " id="div_{{each_question.question_number}}_OptionC" style="vertical-align:middle;"><span></span>
                  <a href="javascript:void(0)">
                  <label class="radio" for="radio_{{each_question.question_number}}_C">
                    <input name="radio_{{each_question.question_number}}" id="radio_{{each_question.question_number}}_C" value="C" type="radio">
                    <span></span> 
                  </label>                    
                    {{ each_question.answer.c.text }}<br>
                    {% if each_question.answer.c.image != '' %}
                      <img src="/static/images/{{exam_code}}/{{each_question.answer.c.image}}" style=" height:140px;" />
                    {% endif %}
                    </a>
            </div>
          </li>

          <li class="field" style="min-height:30px;">
            <div class="clickDiv " id="div_{{each_question.question_number}}_OptionD" style="vertical-align:middle;"><span></span>
                  <a href="javascript:void(0)">
                  <label class="radio" for="radio_{{each_question.question_number}}_D">
                    <input name="radio_{{each_question.question_number}}" id="radio_{{each_question.question_number}}_D" value="D" type="radio">
                    <span></span> 
                  </label>                                
                    {{ each_question.answer.d.text }}<br>
                    {% if each_question.answer.d.image != '' %}
                      <img src="/static/images/{{exam_code}}/{{each_question.answer.d.image}}" style="height:140px;" />
                    {% endif %}
                    </a>
            </div>            
          </li>       
        </ul>          
        </div>
    {% endfor %}                  
        <div style=" height: 40px; margin-left: -2%;" class="twelve columns">
        
        {% if not page_end %}
          <span>
            <div class="small primary btn pretty loadPrev" id="loadPrev">
              <a href="javascript:void(0)"  data-intro="Attempt previous question" data-position="top"><i class="icon-arrow-left"></i>Previous</a>
            </div>
          </span>
          <span style="float:right">
            <div class="small primary btn pretty loadNext" id="loadNext">
              <a href="javascript:void(0)" data-intro="Attempt this question later" data-position="top"><i class="icon-arrow-right" ></i>Skip to Next</a>
            </div>
          </span>

          {% else %}              
            <span>
              <div class="small primary btn pretty oadPrev" id="loadPrev">
                <a href="javascript:void(0)"  data-intro="Attempt previous question" data-position="top"><i class="icon-arrow-left"></i>Previous</a>
              </div>
            </span>

            <span style="float:right">
              <div class="small primary btn pretty" id="ansSubmit">
                <a href="javascript:void(0)" data-intro="" data-position="top"><i class="icon-arrow-right"></i>Submit</a>
              </div>
            </span>
          {%  endif %}

        </div> 
      </div> 
        

    <div id="resultsdiv" style="visibility:hidden;" class="pretty medium primary btn switch" gumby-trigger="#modalwarning"></div>
    <div class="modal" id="modalwarning">
      <div class="content">
        <a id= "closegumby" class="close switch" gumby-trigger="|#modalwarning"><i class="icon-cancel" /></i></a>
        <div class="row">
          <div id="dangerMessage"></div>
          <div class="ten columns centered text-center" style="margin-top:6%;">
            <p id="infoText">When you submit you cannot return back and reattempt or change answers. Are you sure you want to submit? </p>
              <li class="prepend field">
                <div class="medium primary btn" >
                  <a href="#" onclick="set_exam_finished()">Submit</a>
                </div>
                <div class="medium primary btn" style="margin-left: 1%;">
                    <a id="reviewAns" href="#" onclick="review()">Cancel</a>
                </div>
              </li>
          </div>
        </div>
      </div>
    </div> 
    </div>
    </div> 
  </div>  
{% endblock %}
{% block javascript %}
<script type="text/x-mathjax-config">
  //MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    },
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script src="/static/js/chardinjs.min.js"></script> 
<script type="text/javascript">
var click_count = 1;
var div_count = 0;
var ans_list=[];
/*var ans_na = [];*/

var question_id = '{{start_question.uid.id|safe}}';

var current_question_number = {{start_question_number}};
var all_answers = {{all_answers|safe}};
var max_questions_number = {{max_questions_number}};
var attempted = [];
var exam_code = {{exam_code|safe}};
var questions = {{questions|safe}};
var exam_duration = {{exam_details.exam_duration}};



/*(function() {
  $(function() {
    $('body').chardinJs();
    $('a[data-toggle="chardinjs"]').on('click', function(e) {
      e.preventDefault();
        return ($('body').data('chardinJs')).toggle();
        });
      });    
}).call(this);*/
</script>
<script src="/static/js/ajax-handle.js"></script>
<!-- <script src="/static/js/exam.js"></script> -->
<script type="text/javascript">
var exm_code = {{exam_code|safe}};
  function set_exam_finished(){
    ajax_set_exam_finished(exm_code, true);
  }
  function review(){
    $('#closegumby').click();
  }

$('#ansSubmit').on('click', function(){
  $('#resultsdiv').click();
});

var current_pg_num = {{current_pg_num|safe}};
$('#showExam').on('click', '#loadNext', function(){
  get_next_page(exm_code, current_pg_num, 1);
});

$('#showExam').on('click', '#loadPrev', function(){
  get_next_page(exm_code, current_pg_num, -1);
});

$('#showExam').on('click', '#ansSubmit', function(){
  load_result(exm_code);
});


$('#showExam').on('click', '.clickDiv' , function(){

  var clicked = this.id.substring(4, 4 + this.id.substr(4,this.id.length).indexOf('_'));
  var option  = this.id.substring(this.id.indexOf('Option')+6,this.id.length);
  var check_id = "#radio_"+clicked + '_' + option;
  $(check_id).trigger('gumby.check');
  var q_id = this.parentElement.parentNode.id;
  ret_value = save_answer(exm_code, q_id, option.toLowerCase(), clicked);

});
/*if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) {
}
else{
  $("#optionsDiv > ul > li").hover(function(){
  id = this.id;
  $("#"+id).css("background","#58c026");
  },function(){
  $("#"+id).css("background","none");
});
}*/

var exam_state = 0;

function start_ioe_exam()
{
  $("#exam_login_container").hide();
  $("#exam_questions").show();
  $('#osk-container').hide();
}


$("#full_screen_content").hide();
$("#ioe_exam_zoomer").hide();
$("#exam_questions").hide();
  var debug = true;
  $(function () {
        $('#exam_login_container').children('.osk-trigger').onScreenKeyboard({
          rewireReturn : 'submit',
          draggable:true,
          topPosition:"inherit",
          rewireTab : true,
          container:'#full_screen_content'
        });
      });
  

  function show_fullscreen()
  {
    
    $("#full_screen_content").show();
    $("#ioe_exam_starter").hide();
    screenfull.request(document.getElementById('full_screen_content'));
    if(!$('#osk-container').is(':visible')&& exam_state==0)
    {

      exam_state = 1;
      $("#ioe_exam_zoomer").show();
    $('#osk-container').show();
    $( "#osk-container" ).addClass("keyboard-style");
  }

  
  }



  
function clear_login()
{
  $("#exam_username").val('');
  $("#exam_password").val('');
}

  $(document).on("keypress keyup keydown", function(e) {
  // screenfull.request(document.getElementById('body'));
    e.preventDefault();
      return false;
  });



  <!--

  //Disable right mouse click Script
  //By Maximus (maximus@nsimail.com) w/ mods by DynamicDrive
  //For full source code, visit http://www.dynamicdrive.com



  // ///////////////////////////////////
  function clickIE4(){
  if (event.button==2){

  return false;
  }
  }

  function clickNS4(e){
  if (document.layers||document.getElementById&&!document.all){
  if (e.which==2||e.which==3){

  return false;
  }
  }
  }

  if(!debug){

  if (document.layers){
  document.captureEvents(Event.MOUSEDOWN);
  document.onmousedown=clickNS4;
  }
  else if (document.all&&!document.getElementById){
  document.onmousedown=clickIE4;
  }

  document.oncontextmenu=new Function("return false;");
  }
  // --> 


</script>
{% endblock %}