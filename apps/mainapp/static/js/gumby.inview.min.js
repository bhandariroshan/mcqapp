!function(e){"use strict";function t(e){Gumby.debug("Initializing InViewWatcher",e);this.$el=e;var t=this;this.setup();this.$el.on("gumby.initialize",function(){Gumby.debug("Re-initializing InViewWatcher",t.$el);t.setup()})}t.prototype.setup=function(){Gumby.debug("Setting up instance of InViewWatcher",this.$el);this.targets=this.parseTargets();var e=Gumby.selectAttr.apply(this.$el,["classname"]);if(!e){this.classname="active";this.classnameBottom="";this.classnameTop=""}else{if(e.indexOf("|")>-1){e=e.split("|");this.classname=e[0];this.classnameBottom=e[1]||"";this.classnameTop=e[2]||e[1]||""}else{this.classname=e;this.classnameBottom="";this.classnameTop=""}}var t=Gumby.selectAttr.apply(this.$el,["offset"]);if(t!=false){t=t.split("|")}else{t=0}this.offset=t[0]||0;this.offsetTop=t[1]||t[0]||0;this.offsetBottom=this.offset};t.prototype.parseTargets=function(){var t=Gumby.selectAttr.apply(this.$el,["target"]);if(!t){return false}var n=t.split("|");if(n.length===1){return e(n[0])}return e(n.join(", "))};var n,r,i,s,o,u,a,f,l=e(window).height(),c=[];e(window).on("scroll",function(t){n=e(this).scrollTop();for(r=0;r<c.length;r++){i=c[r];s=i.targets||i.$el;if(i.$el.css("display")=="none"){break}o=i.$el.offset().top;u=i.$el.height();a=i.offsetTop;f=i.offsetBottom;var h=o>n-f+l;var p=o+u-a<n;if(!p&&!h){if(s.hasClass(i.classnameTop)){s.removeClass(i.classnameTop)}if(s.hasClass(i.classnameBottom)){s.removeClass(i.classnameBottom)}if(!s.hasClass(i.classname)){s.addClass(i.classname);s.trigger("gumby.inview")}}else if(p&&!h){if(s.hasClass(i.classname)){s.removeClass(i.classname)}if(s.hasClass(i.classnameBottom)){s.removeClass(i.classnameBottom)}if(!s.hasClass(i.classnameTop)){s.addClass(i.classnameTop);s.trigger("gumby.offtop")}}else if(h&&!p){if(s.hasClass(i.classname)){s.removeClass(i.classname)}if(s.hasClass(i.classnameTop)){s.removeClass(i.classnameTop)}if(!s.hasClass(i.classnameBottom)){s.addClass(i.classnameBottom);s.trigger("gumby.offbottom")}}}});e(window).on("resize",function(){l=e(this).height();e(window).trigger("scroll")});e(window).load(function(){e(window).trigger("scroll")});Gumby.addInitalisation("inview",function(n){e(".inview").each(function(){var r=e(this);if(r.data("isInView")&&!n){return true}else if(r.data("isInView")&&n){r.trigger("gumby.initialize")}r.data("isInView",true);c.push(new t(r))});e(window).trigger("scroll")});Gumby.UIModule({module:"inview",events:["initialize","trigger","onTrigger"],init:function(){Gumby.initialize("inview")}})}(jQuery)